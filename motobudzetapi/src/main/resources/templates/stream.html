<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Screen and Audio Capture</title>
</head>
<style>
  .resize-image {
    width: 1024px;
    height: 768px;
    object-fit: cover;
  }
</style>
<body>
<img id="screenImage" alt="Screen Capture" class="resize-image"/>
<!-- Usunięto kontrole z elementu audio, aby użytkownik nie musiał włączać dźwięku ręcznie -->
<audio id="audioPlayer"></audio>

<script>
  const image = document.getElementById('screenImage');
  const audioPlayer = document.getElementById('audioPlayer');
  const refreshRate = 1000 / 30; // Odświeżanie 30 razy na sekundę

  async function updateMedia() {
    try {
      // Update image
      const imgResponse = await fetch('/screen-capture?' + new Date().getTime());
      const imgBlob = await imgResponse.blob();
      image.src = URL.createObjectURL(imgBlob);

      // Update audio
      const audioResponse = await fetch('/audio-capture?' + new Date().getTime());
      const audioBlob = await audioResponse.blob();
      if (!audioPlayer.src || audioPlayer.ended) {
        audioPlayer.src = URL.createObjectURL(audioBlob);
        audioPlayer.play();
      }
    } catch (error) {
      console.error('Błąd podczas pobierania mediów:', error);
    }
  }

  setInterval(updateMedia, refreshRate);
</script>
</body>
</html>
