<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
    <title>Moto-Bud≈ºet</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/navBarMainContainerLogoAdvertisement.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/searchForm.css}" />
    <script type="text/javascript" th:src="@{/js/navBarMainContainerLogo.js}" ></script>
    <style>

        .left-container {
            width: 100%; /* Pe≈Çna szeroko≈õƒá */
            max-width: 300px; /* Maksymalna szeroko≈õƒá */
            min-height: 500px;
            margin: 0 20px;
            background-color: #181818;
            border-radius: 30px;
            box-shadow: 0 0 40px darkgoldenrod;
            border: 0 dashed darkgoldenrod;
            display: flex;
            flex-direction: column;
            justify-content: center;
            flex-wrap: wrap;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            transition: box-shadow 0s ease-in-out;
            flex-basis: calc(33.33% - 20px);
            /*flex-basis: auto;*/

        }
        .right-container {
            width: 100%; /* Pe≈Çna szeroko≈õƒá */
            max-width: 1500px; /* Maksymalna szeroko≈õƒá */
            min-height: 500px;
            margin: 0 20px;
            background-color: #181818;
            border-radius: 30px;
            box-shadow: 0 0 40px darkgoldenrod;
            border: 0 dashed darkgoldenrod;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            flex: 1;
            padding: 20px;
            box-sizing: border-box;
            transition: box-shadow 0s ease-in-out;
            flex-basis: auto;
        }
        .result-container-right{
            margin-top: 30px;
            margin-left: 20px;
            margin-right: 20px;
            color: darkgoldenrod;
            background-color: #181818;
            display: flex;
            flex-direction: column;
            justify-content: center; /* Wy≈õrodkowanie w poziomie */
            align-items: center; /* Wy≈õrodkowanie w pionie */
            width: 100%;
            max-width: 100%;
            max-height: 100%;
            box-sizing: border-box;
            flex-basis: auto;
        }

        #resultContainerRight::-webkit-scrollbar {
            width: 5px; /* Szeroko≈õƒá paska przewijania */
        }

        #resultContainerRight::-webkit-scrollbar-thumb {
            background-color: darkgoldenrod; /* Kolor paska przewijania */
            border-radius: 10px; /* ZaokrƒÖglenie rant√≥w paska przewijania */
        }

        #resultContainerRight::-webkit-scrollbar-track {
            background-color: transparent; /* Kolor t≈Ça paska przewijania */
        }

        .header-container-account {
            width: 100%; /* Pe≈Çna szeroko≈õƒá */
            max-width: 1500px; /* Maksymalna szeroko≈õƒá */
            height: 40px;
            margin: 5px;
            background-color: #181818;
            /*border-radius: 30px;*/
            /*box-shadow: 0 0 40px darkgoldenrod;*/
            border: 0 dashed darkgoldenrod;
            display: flex;
            /*flex-wrap: wrap;*/
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            transition: box-shadow 0s ease-in-out;
            flex-basis: auto;
        }
        .title-container-account {
            width: 100%; /* Pe≈Çna szeroko≈õƒá */
            max-width: 1000px; /* Maksymalna szeroko≈õƒá */
            height: 100px;
            margin: 0 20px;
            background-color: #181818;
            border-radius: 30px;
            box-shadow: 0 0 40px darkgoldenrod;
            border: 0 dashed darkgoldenrod;
            display: flex;
            /*flex-wrap: wrap;*/
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            transition: box-shadow 0s ease-in-out;
            flex-basis: auto;
        }
        .line {
            width: 100%; /* Pe≈Çna szeroko≈õƒá */
            max-width: 1000px; /* Maksymalna szeroko≈õƒá */
            height: 2px;
            /*margin: 0 20px;*/
            background-color: #181818;
            /*border-radius: 30px;*/
            box-shadow: 0 0 1px darkgoldenrod;
            border: 0 dashed darkgoldenrod;
            display: flex;
            /*flex-wrap: wrap;*/
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            transition: box-shadow 0s ease-in-out;
            flex-basis: auto;
        }
        .container-main2 {
            width: 1500px;
            margin: 150px auto 0;
            background-color: black;
            border: 2px solid darkgoldenrod;
            padding: 20px;
            display: flex;
            border-radius: 30px;
            box-shadow: 0 0 30px moccasin;
            animation: fade-in-main 1s ease-out;
            max-width: 100%;
            /*flex-wrap: wrap;*/
            align-items: flex-start;
            justify-content: flex-start; /* Zmiana na flex-start */
            /*justify-content: space-between;*/
        }

        .child-element {
            flex-basis: calc(33.33% - 20px); /* Dla trzech kolumn (zmie≈Ñ warto≈õƒá na potrzeby) */
            margin-bottom: 20px;
            box-sizing: border-box;
            padding: 10px;
            background-color: white; /* Przyk≈Çadowy kolor t≈Ça dla element√≥w dziecka */
            border: 2px solid blue; /* Przyk≈Çadowa ramka dla element√≥w dziecka */
        }
    </style>
</head>

<body>
<header>
    <div class="looogo">
    <a href="/">
        <img alt="Logo" id="logo" src="">
    </a>
    </div>
    <div class="nav-buttons">
        <a href="/advertisement/new">Sprzedaj</a>
        <a href="/messages">Wiadomosci</a>
        <a href="/favourites">Ulubione</a>
        <a href="/account"><span id="principalName" th:text="${principalName}"></span></a>
        <a href="/logout" th:if="${logout != null}">
            <span id="logout" th:text="${logout}"></span>
        </a>
    </div>
</header>
<div class="container-main2" id="container-main2">
    <div class="left-container" id="left-container"></div>
    <div class="right-container" id="rightContainer">
        <div class="header-container-account" id="headerContainer"></div>
        <div class="result-container-right" id="resultContainerRight"></div>
    </div>
</div>
<span id="loadFunction" th:text="${loadFunction}" style="display: none;"></span>
<script>

    document.addEventListener("DOMContentLoaded", function () {
        createButtons();
        loadFunctionHref();
        // loadPreviousButton();
    });

    function loadFunctionHref(){
        let loadFunctionValue = document.getElementById("loadFunction").textContent;
        window[loadFunctionValue](loadFunctionValue);
        if (loadFunctionValue === "Wiadomosci" || loadFunctionValue === "Ulubione") {
            UkryjMenu();
        }
    }

    function Profil(buttonName) {
        createHeader(buttonName);
    }
    function Ogloszenia(buttonName) {
        createHeader(buttonName);
    }
    function Wiadomosci(buttonName) {
        createHeader(buttonName);
        loadConversations();
    }
    function Ulubione(buttonName) {
        createHeader(buttonName);
    }
    function Ustawienia(buttonName) {
        createHeader(buttonName);
    }
    function UkryjMenu(buttonName) {
        let leftContainer = document.getElementById('left-container');
        leftContainer.remove();
    }

    function loadConversations() {

        // let userName = document.getElementById("principalName").textContent;
        let url = `/api/conversations`;
        let resultContainerRight = document.getElementById("resultContainerRight");


        fetch(url)
            .then((response) => {
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            })
            .then((data) => {
                let resultCount = 0;
                if (data.length === 0) {
                    resultContainerRight.textContent = "Nie znaleziono ≈ºadnych wiadomo≈õci";
                } else {
                    data.forEach(conversation => {
                        const resultDiv = createResultDiv(conversation,resultContainerRight);
                        resultCount++;
                        resultContainerRight.appendChild(resultDiv);
                    });
                }
                if(resultCount>0){
                    resultContainerRight.style.maxHeight = "600px";
                    resultContainerRight.style.overflowY = "auto";
                    resultContainerRight.style.overflowX = "hidden";
                    resultContainerRight.style.paddingTop = "120px"; // Dodaj g√≥rny padding
                    resultContainerRight.style.paddingBottom = "30px"; // Dodaj dolny padding
                    resultContainerRight.style.paddingLeft = "20px"; // Dodaj dolny padding
                    resultContainerRight.style.paddingRight = "20px"; // Dodaj dolny padding
                    resultContainerRight.style.scrollbarWidth = "thin"; // Ustaw szeroko≈õƒá paska przewijania
                    resultContainerRight.style.scrollbarColor = "darkgoldenrod transparent"; // Ustaw kolory paska przewijania
                }
            })
            .catch((error) => {
                console.error("Fetch error:", error);
            });
    }

    function createResultDiv(conversation,resultContainerRight) {
        const resultDiv = document.createElement("resultDiv");
        resultDiv.id = "resultDiv";
        resultDiv.style.width = "100%";
        resultDiv.style.maxWidth = "100%";
        resultDiv.style.boxSizing = "border-box";
        resultDiv.style.flexBasis = "auto";
        resultDiv.style.height = "auto";
        resultDiv.style.backgroundColor = "#181818";
        resultDiv.style.margin = "0 20px";
        resultDiv.style.marginBottom = "15px";
        resultDiv.style.padding = "10px";
        resultDiv.style.display = "flex";
        resultDiv.style.borderRadius = "30px";
        resultDiv.style.cursor = "pointer";
        resultDiv.style.animation = "fade-in 1s ease-in-out forwards";

        // Add hover effect on mouseover
        resultDiv.onmouseover = () => {
            resultDiv.style.boxShadow = "0 0 20px moccasin";
        };

        // Remove hover effect on mouseout
        resultDiv.onmouseout = () => {
            resultDiv.style.boxShadow = "0 0 0px darkgoldenrod";
        };

        // Set the onclick event to fetch and display messages for this conversation
        resultDiv.onclick = () => {
            resultDiv.onmouseover = null;
            resultDiv.onclick = null;
            resultDiv.style.cursor = "default";
            resultDiv.style.boxShadow = "0 0 0px darkgoldenrod";
            resultContainerRight.innerHTML = "";

            conversationDetailsMain.removeChild(conversationLastMessage);
            conversationDetailsMain.removeChild(conversationDeliveryDateTime);

            fetchAdvertisementMessages(conversation, resultContainerRight, resultDiv);

        };




        const photoElement = document.createElement("img");
        photoElement.src = `/api/resources/advertisementPhoto/miniature/${conversation.advertisement.mainPhotoUrl}`;
        photoElement.style.height = "150px";
        photoElement.style.width = "100px";
        photoElement.style.objectFit = "cover";

        const fadeEffect = document.createElement('div');
        fadeEffect.classList.add('fade-effect-miniature-search');
        fadeEffect.appendChild(photoElement);

        resultDiv.appendChild(fadeEffect);

        const conversationDetailsHeader = document.createElement("conversationDetailsHeader");
        conversationDetailsHeader.style.width = '100%'; // Dopasowanie do szeroko≈õci resultDiv
        conversationDetailsHeader.style.display = 'flex'; // Ustawienie flexbox
        conversationDetailsHeader.style.justifyContent = 'space-between'; // Umieszczenie element√≥w na ko≈Ñcach kontenera
        conversationDetailsHeader.style.alignItems = 'center'; // Wy≈õrodkowanie element√≥w w pionie
        conversationDetailsHeader.style.boxSizing = "border-box";
        conversationDetailsHeader.style.flexBasis = "auto";

        const nameElement = document.createElement("div");
        nameElement.textContent = conversation.advertisement.name;
        nameElement.style.color = "white"; // Dostosuj kolor tekstu
        nameElement.style.fontSize = "24px"; // Dostosuj rozmiar tekstu
        nameElement.style.textAlign = 'left';


        conversationDetailsHeader.appendChild(nameElement);

        if (conversation.lastMessage !== null) {
            const dateElement = document.createElement("div");
            dateElement.textContent = conversation.lastMessage.messageSendDate;
            dateElement.style.color = "darkgoldenrod"; // Dostosuj kolor tekstu
            dateElement.style.fontSize = "18px"; // Dostosuj rozmiar tekstu
            dateElement.style.textAlign = 'right';
            dateElement.style.marginRight = '15px';
            dateElement.style.whiteSpace = 'nowrap'; // Tekst nie lami siƒô na wiele linii
            conversationDetailsHeader.appendChild(dateElement);
        }

        ///////////////////////////////////////////////////////////////////////
        ///////////////////////////////HEADER//////////////////////////////////
        ///////////////////////////////////////////////////////////////////////


        const conversationDetailsDiv = document.createElement("conversationDetailsDiv");
        conversationDetailsDiv.style.width = '100%'; // Dopasowanie do szeroko≈õci resultDiv
        conversationDetailsDiv.style.flexBasis = 'auto';
        conversationDetailsDiv.style.display = 'flex-start';
        conversationDetailsDiv.style.flexDirection = 'column'; // Ustawienia pionowego uk≈Çadu


        const conversationDetailsMain = document.createElement("conversationDetailsMain");
        conversationDetailsMain.style.width = '100%'; // Dopasowanie do szeroko≈õci resultDiv
        conversationDetailsMain.style.flexBasis = 'auto';
        conversationDetailsMain.style.display = 'grid';
        conversationDetailsMain.style.gridTemplateRows = 'auto 1fr auto'; // Rozk≈Çad na trzy sekcje: g√≥rnƒÖ, ≈õrodkowƒÖ i dolnƒÖ


        const conversationDetailsSecondUser = document.createElement("conversationDetailsCenter");
        conversationDetailsSecondUser.style.width = '100%'; // Dopasowanie do szeroko≈õci resultDiv
        conversationDetailsSecondUser.style.flexBasis = 'auto';
        conversationDetailsSecondUser.innerHTML = "Konwersacja z ‚Üí <strong style='font-size: 1.4em;'>" + conversation.secondUser + "</strong>";


        const advertisementDetails = document.createElement("conversationDetailsBottom");
        advertisementDetails.style.width = '75%'; // Dopasowanie do szeroko≈õci resultDiv
        advertisementDetails.style.flexBasis = 'auto';
        advertisementDetails.style.display = 'flex';
        advertisementDetails.style.marginTop = '15px';


        const containers = [
            createInfoContainer('mileage', 'MileageIcon', conversation.advertisement.mileage),
            createInfoContainer('productionDate', 'ProductionDateIcon', conversation.advertisement.productionDate),
            createInfoContainer('fuelType', 'FuelTypeIcon', conversation.advertisement.fuelType),
            createInfoContainer('engineHorsePower', 'EngineIcon', conversation.advertisement.engineHorsePower + 'HP'),
        ];

        if (conversation.fuelType !== 'ELEKTRYCZNY') {
            containers.push(
                createInfoContainer('engineType/' + conversation.advertisement.engineType, 'transmissionIcon', conversation.advertisement.engineType),
                createInfoContainer('transmissionType/' + conversation.advertisement.transmissionType, 'transmissionIcon', conversation.advertisement.transmissionType)
            );
        }

        const maxTextWidth = Math.max(
            ...containers.map(container => container.querySelector('span').offsetWidth)
        );

        containers.forEach(container => {
            container.style.width = maxTextWidth + 'px';
            container.style.maxWidth = "100%";
            container.style.boxSizing = "border-box";
            container.style.flexBasis = "auto";
            advertisementDetails.appendChild(container);
        });

        const conversationLastMessage = document.createElement("conversationLastMessage");
        conversationLastMessage.style.width = '100%'; // Dostosowanie do szeroko≈õci
        conversationLastMessage.style.overflow = 'hidden'; // Ukrywa nadmiarowy tekst
        conversationLastMessage.style.textOverflow = 'ellipsis'; // Dodaje trzy kropki na ko≈Ñcu, gdy tekst jest zbyt d≈Çugi
        conversationLastMessage.style.whiteSpace = 'nowrap'; // Tekst nie lami siƒô na wiele linii

        if (conversation.lastMessage === null) {
            conversationLastMessage.textContent += 'Brak Wiadomo≈õci';
        } else {
            const lastMessageValue = document.createElement("lastMessageValue");
            lastMessageValue.style.color = "white"; // Dostosuj kolor tekstu
            lastMessageValue.style.fontSize = "24px"; // Dostosuj rozmiar tekstu
            lastMessageValue.style.textAlign = 'right';
            lastMessageValue.style.marginLeft = 'auto'; // Przesuniƒôcie na prawƒÖ stronƒô
            lastMessageValue.textContent = conversation.lastMessage.userSender + ' : ' + conversation.lastMessage.message;
            conversationLastMessage.appendChild(lastMessageValue);
        }


        const conversationDeliveryDateTime = document.createElement("deliveryDateTime");
        conversationDeliveryDateTime.style.color = "white"; // Dostosuj kolor tekstu
        conversationDeliveryDateTime.style.fontSize = "24px"; // Dostosuj rozmiar tekstu
        conversationDeliveryDateTime.style.textAlign = "right"; // Dostosuj rozmiar tekstu

        if (conversation.lastMessage === null) {
            conversationDeliveryDateTime.textContent += 'Brak Wiadomo≈õci';
        } else {
            if (conversation.lastMessage.messageReadTime === null) {
                conversationDeliveryDateTime.textContent += 'Dostarczono : ' + conversation.lastMessage.messageSendTime;
            } else {
                conversationDeliveryDateTime.textContent += 'Wyswietlono : ' + conversation.lastMessage.messageReadTime;
            }
        }


        conversationDetailsMain.appendChild(conversationDetailsSecondUser);
        conversationDetailsMain.appendChild(advertisementDetails);
        conversationDetailsMain.appendChild(conversationLastMessage);
        conversationDetailsMain.appendChild(conversationDeliveryDateTime);

        conversationDetailsDiv.appendChild(conversationDetailsHeader);
        conversationDetailsDiv.appendChild(conversationDetailsMain);



        resultDiv.appendChild(conversationDetailsDiv);

        return resultDiv;
    }

    function fetchAdvertisementMessages(conversation,resultContainerRight,resultDiv) {

        let rightContainer = document.getElementById("rightContainer");
        rightContainer.style.color = 'darkgoldenrod';
        rightContainer.insertBefore(resultDiv,resultContainerRight);
        resultDiv.style.marginTop = '20px';
        resultDiv.style.paddingleft = '20px';
        resultDiv.style.paddingRight = '20px';
        resultContainerRight.style.paddingTop = '15px';

        const conversationId = conversation.conversationId;
        const url = `/api/messages?conversationId=${conversationId}`;

        fetch(url)
            .then(response => response.json())
            .then(messages => {
                messages.forEach(message => {
                    createMessageContainer(message,resultContainerRight,conversation);
                });
                    createMessageInputContainer(resultContainerRight,conversation);
                    resultContainerRight.scrollTop = resultContainerRight.scrollHeight;
            }
            )
            .catch(error => {
                console.error("WystƒÖpi≈Ç b≈ÇƒÖd podczas pobierania wiadomo≈õci:", error);
            });
    }

    function sendMessage(messageInput, conversation, resultContainerRight, messageInputDiv) {
        // Pobierz tre≈õƒá z pola tekstowego
        const messageText = messageInput.value;
        const conversationId = conversation.conversationId;

        const messageObject = {
            message: messageText,
            userSender: document.getElementById('principalName').textContent  // Przyjmujƒô, ≈ºe masz dostƒôp do loggedUser w zakresie
        };

        // Sprawd≈∫, czy tre≈õƒá wiadomo≈õci nie jest pusta
        if (messageText.trim() !== "") {
            // Stw√≥rz obiekt FormData z danymi formularza
            const formData = new FormData();
            formData.append("message", messageText);
            formData.append("conversationId", conversationId);

            // Wys≈Çanie danych jako ≈ºƒÖdanie POST z danymi formularza
            fetch("/api/messages", {
                method: "POST",
                body: formData,
                headers: {
                    // Tutaj mo≈ºesz ustawiƒá odpowiednie nag≈Ç√≥wki, np. "Content-Type"
                }
            })
                .then(response => response.json())
                .then(response => {
                    console.log(response);
                })
                .catch(error => {
                    console.error("B≈ÇƒÖd podczas wysy≈Çania wiadomo≈õci:", error);
                });

            createMessageContainer(messageObject,resultContainerRight,conversation);
            resultContainerRight.scrollTop = resultContainerRight.scrollHeight;

            // Wyczy≈õƒá pole tekstowe po wys≈Çaniu
            messageInput.value = "";
        }
    }

    function createMessageInputContainer(resultContainerRight, conversation) {

        const messageInputDiv = document.createElement("inputDiv");

        messageInputDiv.id = 'inputDiv';
        messageInputDiv.style.width = '600px';
        messageInputDiv.style.height = '50px';
        messageInputDiv.style.alignItems = 'center'; // Wy≈õrodkowanie w pionie
        messageInputDiv.style.maxWidth = '100%';
        messageInputDiv.style.boxSizing = 'border-box';
        messageInputDiv.style.flexGrow = '1'; // R√≥wnomiernie roz≈Ço≈ºenie element√≥w

        // Tworzenie pola tekstowego
        const messageInput = document.createElement("textarea");

        messageInput.style.width = '550px'; // Ustaw szeroko≈õƒá na 500px
        messageInput.style.height = '40px'; // Ustaw wysoko≈õƒá na 100px
        messageInput.placeholder = "Wpisz wiadomo≈õƒá...";
        messageInput.style.color = 'white'; // Ustaw kolor tekstu na bia≈Çy
        messageInput.style.resize = 'none';
        messageInput.style.borderRadius = '10px'; // Dodaj zaokrƒÖglone rogi o promieniu 10px
        messageInput.style.backgroundColor = '#181818'; // Ustaw t≈Ço na kolor #181818
        messageInput.style.maxWidth = '100%';
        messageInput.style.boxSizing = 'border-box';
        messageInput.style.flexGrow = '1'; // R√≥wnomiernie roz≈Ço≈ºenie element√≥w



        // Tworzenie przycisku "Wy≈õlij"
        const sendButton = document.createElement("button");
        sendButton.textContent = "Wy≈õlij";

        // Obs≈Çuga zdarzenia klikniƒôcia przycisku "Wy≈õlij"
        sendButton.addEventListener("click", function () {
            sendMessage(messageInput, conversation, resultContainerRight, messageInputDiv);
        });

        messageInput.addEventListener("keydown", function (event) {
            if (event.key === "Enter") {
                event.preventDefault();
                sendMessage(messageInput, conversation, resultContainerRight, messageInputDiv);
            }
        });

        messageInputDiv.appendChild(messageInput);
        messageInputDiv.appendChild(sendButton);
        let rightContainer = document.getElementById("rightContainer");
        rightContainer.appendChild(messageInputDiv);
    }

    function createMessageContainer(message,resultContainerRight,conversation){

        const div = document.createElement("messageContainerDiv");
        div.style.marginBottom = '30px';
        div.style.maxWidth = '50%';
        div.style.display = 'flex'; // Dodaj display:flex, aby elementy wewnƒÖtrz div by≈Çy r√≥wno roz≈Ço≈ºone
        div.style.alignItems = 'center'; // Wyr√≥wnaj wertykalnie elementy

        if(message.userSender !== conversation.secondUser) {
            div.style.textAlign = 'right';
            div.style.marginLeft = 'auto'; // Przesuniƒôcie na prawƒÖ stronƒô
        } else {
            div.style.textAlign = 'left';
            div.style.marginRight = 'auto'; // Przesuniƒôcie na prawƒÖ stronƒô
        }

        const messageElement = document.createElement("messageContainerSingle");

        messageElement.style.border = '2px dashed darkgoldenrod';
        messageElement.style.padding = '10px';
        // messageElement.style.marginTop = '10px';
        // messageElement.style.marginRight = '10px';
        // messageElement.style.marginLeft = '10px';
        // messageElement.style.marginBottom = '10px';
        messageElement.style.borderRadius = '10px'; // Dodaj zaokrƒÖglonƒÖ ramkƒô 10px
        messageElement.style.color = 'white'; // Dodaj zaokrƒÖglonƒÖ ramkƒô 10px
        messageElement.style.overflowWrap = 'break-word'; // U≈ºyj overflow-wrap zamiast word-wrap
        messageElement.style.textAlign = 'left';
        messageElement.style.marginRight = 'auto'; // Przesuniƒôcie na prawƒÖ stronƒô
        messageElement.textContent = message.message;


        const userNameElement = document.createElement("userNameDiv");
        userNameElement.style.marginRight = '10px';
        userNameElement.style.position = 'relative';
        userNameElement.style.top = "10px";
        userNameElement.style.flexShrink = '0'; // Nie zmniejszaj rozmiaru userNameElement

        /*
        CHARS
        [‚§§],[‚é≥],[üù´],
        */
        userNameElement.innerHTML = "<strong style='font-size: 1.2em;'>" +  message.userSender + " ‚§§ </strong>";

        div.appendChild(userNameElement);
        div.appendChild(messageElement);
        resultContainerRight.appendChild(div);
    }

    function createInfoContainer(iconPath, altText, value) {
        const container = document.createElement('div');
        container.style.display = 'flex';
        container.style.flexDirection = 'column';
        container.style.alignItems = 'center';
        container.style.flexGrow = '1'; // R√≥wnomiernie roz≈Ço≈ºenie element√≥w
        container.style.textAlign = 'center';
        container.style.marginRight = '30px';



        const icon = document.createElement('img');
        icon.src = `/api/resources/${iconPath}`;
        icon.alt = altText;
        icon.style.marginBottom = '2px';

        const valueElement = document.createElement('span');
        valueElement.textContent = value;

        container.appendChild(icon);
        container.appendChild(valueElement);

        return container;
    }

    function createHeader(buttonName){


        let headerContainer = document.getElementById("headerContainer");
        headerContainer.textContent = buttonName.replace("_", " ");
        headerContainer.style.color = "darkgoldenrod";
        headerContainer.style.fontWeight = "bold";
        headerContainer.style.fontSize = "32px";
        headerContainer.style.flexBasis = "auto";

        let hrLine = document.createElement("hr");
        hrLine.style.boxShadow = "0 0 5px darkgoldenrod"; // Kolor cienia darkgoldenrod, mniejszy rozmiar
        hrLine.style.height = "1px";
        hrLine.style.width = "100%";
        hrLine.style.maxWidth = "100%";
        hrLine.style.marginLeft = "10px";
        hrLine.style.marginRight = "10px";
        hrLine.style.marginBottom = "5px";
        hrLine.style.border = "none";
        hrLine.style.borderTop = "1px solid transparent"; // Rozpoczƒôcie z przezroczystym kolorem
        hrLine.style.transformOrigin = "center";
        hrLine.style.transition = "transform 0.3s ease-in-out, border-top-color 0.3s ease-in-out"; // Dodanie przej≈õcia zmiany koloru obramowania
        hrLine.style.transform = "scaleX(0)"; // Ustawienie poczƒÖtkowej skali na 0 (ukrycie)
        hrLine.style.flexBasis = "auto";


        headerContainer.appendChild(hrLine); // Dodanie linii do headerContainer

        cleanMessages();

        // Trigger the animation after a slight delay to ensure the element is fully added to the DOM
        setTimeout(() => {
            hrLine.style.transform = "scaleX(1)"; // Skalowanie linii do pe≈Çnej widoczno≈õci
            hrLine.style.borderTopColor = "darkgoldenrod"; // Ustawienie koloru na po≈ºƒÖdany kolor
            // hrLine.style.backgroundImage = "linear-gradient(to left, transparent 0%, darkgoldenrod 50%, transparent 100%)"; // Efekt fade z ≈õrodka w lewo
        }, 100);
    }

    function cleanMessages() {
        let childConversationMessageInputElement = document.getElementById('inputDiv');

        let childConversationResultElements = document.querySelectorAll('#rightContainer [id^="resultDiv"]');

        childConversationResultElements.forEach(element => {
            element.parentNode.removeChild(element);
        });

        if (childConversationMessageInputElement) {
            childConversationMessageInputElement.parentNode.removeChild(childConversationMessageInputElement);
        }

        let resultContainerRight = document.getElementById("resultContainerRight");
        resultContainerRight.innerHTML = "";
    }

    function createButtons() {
        const leftContainer = document.getElementById('left-container');
        const buttonNames = ["Profil", "Ogloszenia", "Wiadomosci", "Ulubione", "Ustawienia" , "Ukryj_Menu"];

        buttonNames.forEach(buttonName => {
            const settingsButton = document.createElement("button");
            settingsButton.textContent = buttonName.replace("_", " ");
            settingsButton.style.backgroundColor = "darkgoldenrod";
            settingsButton.style.border = "none";
            settingsButton.style.marginBottom = "20px";
            settingsButton.style.width = "150px";
            settingsButton.style.color = "black";
            settingsButton.style.padding = "10px 20px";
            settingsButton.style.borderRadius = "5px";
            settingsButton.style.boxShadow = "0 0 20px darkgoldenrod";
            settingsButton.style.transition = "background-position 0.3s ease-in-out";

            // settingsButton.addEventListener("click", function () {
            //     let lastButton = document.cookie = `lastButton=${buttonName}`;
            //     console.log(lastButton);
            // });

            settingsButton.addEventListener("mouseover", function () {
                settingsButton.style.boxShadow = '0 0 20px moccasin';
                settingsButton.style.color = "white";
            });

            settingsButton.addEventListener("mouseout", function () {
                settingsButton.style.boxShadow = '0 0 20px darkgoldenrod';
                settingsButton.style.color = "black";
            });
            settingsButton.addEventListener("click", function () {
                // window[buttonName](buttonName.toString()); // Call the corresponding function using bracket notation
                window[buttonName.replace("_", "")].call(this, buttonName.replace("_", "")); // Zamie≈Ñ podkre≈õlenie na spacjƒô i wywo≈Çaj funkcjƒô

                settingsButton.disabled = true;

                // Po 3 sekundach w≈ÇƒÖcz przycisk ponownie
                setTimeout(function () {
                    settingsButton.disabled = false;
                }, 2000);
            });
            leftContainer.appendChild(settingsButton);
        });
    }

    // function loadPreviousButton() {
    //     const cookies = document.cookie.split("; "); // Pobierz wszystkie cookies i podziel na tablicƒô
    //     let lastButton = null;
    //
    //     for (const cookie of cookies) {
    //         const [name, value] = cookie.split("="); // Podziel nazwƒô i warto≈õƒá cookies
    //         if (name === "lastButton") {
    //             lastButton = value;
    //             break;
    //         }
    //     }
    //
    //     if (lastButton) {
    //         window[lastButton](lastButton);
    //         console.log(lastButton);
    //     }
    // }


</script>
</body>
</html>